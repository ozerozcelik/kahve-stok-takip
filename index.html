<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‚òï Kahve Stok Takip</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * { -webkit-tap-highlight-color: transparent; }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .spinner { animation: spin 1s linear infinite; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icons
        const Plus = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>;
        const ShoppingCart = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>;
        const Menu = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>;
        const X = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>;
        const Trash2 = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>;
        const Search = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>;
        const AlertCircle = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>;
        const History = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v5h5"></path><path d="M3.05 13A9 9 0 1 0 6 5.3L3 8"></path><path d="M12 7v5l4 2"></path></svg>;
        const Download = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>;
        const Edit2 = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>;
        const Truck = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M1 3h15v13H1z"></path><path d="M16 8h4l3 3v5h-7V8z"></path><circle cx="5.5" cy="18.5" r="2.5"></circle><circle cx="18.5" cy="18.5" r="2.5"></circle></svg>;
        const Loader = () => <svg className="spinner" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="white" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="2" x2="12" y2="6"></line><line x1="12" y1="18" x2="12" y2="22"></line><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line><line x1="2" y1="12" x2="6" y2="12"></line><line x1="18" y1="12" x2="22" y2="12"></line><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line></svg>;
        const Clock = () => <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>;

        const CoffeeInventory = () => {
            const defaultCategories = [
                { id: 1, name: 'Kahve & √áekirdek', icon: '‚òï' },
                { id: 2, name: 'S√ºt & Krema', icon: 'ü•õ' },
                { id: 3, name: '≈ûeker & Tatlandƒ±rƒ±cƒ±', icon: 'üç¨' },
                { id: 4, name: 'Bardak & Kapak', icon: 'ü•§' },
                { id: 5, name: 'Sos & ≈ûurup', icon: 'üçØ' },
                { id: 6, name: 'Diƒüer Malzemeler', icon: 'üì¶' },
            ];

            const defaultProducts = [
                { id: 1, categoryId: 1, name: 'Espresso √áekirdeƒüi', unit: 'kg', current: 5, orderQty: 0, minStock: 3, supplier: 'Kahve D√ºnyasƒ±', orderStatus: '' },
                { id: 2, categoryId: 1, name: 'Filter Kahve √áekirdeƒüi', unit: 'kg', current: 3, orderQty: 0, minStock: 2, supplier: 'Kahve D√ºnyasƒ±', orderStatus: '' },
                { id: 3, categoryId: 2, name: 'Tam Yaƒülƒ± S√ºt', unit: 'litre', current: 15, orderQty: 0, minStock: 10, supplier: 'Pƒ±nar', orderStatus: '' },
                { id: 4, categoryId: 2, name: 'Laktoz Free S√ºt', unit: 'litre', current: 5, orderQty: 0, minStock: 5, supplier: 'Pƒ±nar', orderStatus: '' },
                { id: 5, categoryId: 3, name: '≈ûeker Paketi', unit: 'adet', current: 200, orderQty: 0, minStock: 100, supplier: 'T√ºrk ≈ûeker', orderStatus: '' },
                { id: 6, categoryId: 3, name: 'Stevia', unit: 'adet', current: 50, orderQty: 0, minStock: 30, supplier: 'Metro', orderStatus: '' },
                { id: 7, categoryId: 4, name: 'K√º√ß√ºk Bardak', unit: 'adet', current: 150, orderQty: 0, minStock: 100, supplier: 'Kaƒüƒ±t Pazarƒ±', orderStatus: '' },
                { id: 8, categoryId: 4, name: 'B√ºy√ºk Bardak', unit: 'adet', current: 120, orderQty: 0, minStock: 80, supplier: 'Kaƒüƒ±t Pazarƒ±', orderStatus: '' },
                { id: 9, categoryId: 4, name: 'Kapak', unit: 'adet', current: 180, orderQty: 0, minStock: 120, supplier: 'Kaƒüƒ±t Pazarƒ±', orderStatus: '' },
                { id: 10, categoryId: 5, name: '√áikolata Sosu', unit: '≈üi≈üe', current: 2, orderQty: 0, minStock: 2, supplier: 'Metro', orderStatus: '' },
            ];

            const [categories, setCategories] = useState(defaultCategories);
            const [products, setProducts] = useState(defaultProducts);
            const [suppliers, setSuppliers] = useState(['Kahve D√ºnyasƒ±', 'Pƒ±nar', 'T√ºrk ≈ûeker', 'Metro', 'Kaƒüƒ±t Pazarƒ±']);
            const [orderHistory, setOrderHistory] = useState([]);
            const [selectedCategory, setSelectedCategory] = useState(null);
            const [searchQuery, setSearchQuery] = useState('');
            const [showMenu, setShowMenu] = useState(false);
            const [showAddCategory, setShowAddCategory] = useState(false);
            const [showAddProduct, setShowAddProduct] = useState(false);
            const [showAddSupplier, setShowAddSupplier] = useState(false);
            const [showManageSuppliers, setShowManageSuppliers] = useState(false);
            const [showHistory, setShowHistory] = useState(false);
            const [showOrderConfirm, setShowOrderConfirm] = useState(false);
            const [editingProduct, setEditingProduct] = useState(null);
            const [newCategory, setNewCategory] = useState({ name: '', icon: 'üì¶' });
            const [newProduct, setNewProduct] = useState({ name: '', unit: 'adet', current: 0, orderQty: 0, minStock: 0, supplier: '', orderStatus: '' });
            const [newSupplier, setNewSupplier] = useState('');
            const [userName, setUserName] = useState('');
            const [showNamePrompt, setShowNamePrompt] = useState(true);
            const [isLoading, setIsLoading] = useState(true);

            useEffect(() => {
                loadData();
            }, []);

            const loadData = async () => {
                setIsLoading(true);
                
                try {
                    // Storage kullanƒ±labilir mi kontrol et
                    if (typeof window.storage !== 'undefined') {
                        // Kategorileri y√ºkle
                        try {
                            const savedCategories = await window.storage.get('coffee-categories');
                            if (savedCategories && savedCategories.value) {
                                setCategories(JSON.parse(savedCategories.value));
                            }
                        } catch (error) {
                            console.log('Kategoriler ilk kez y√ºkleniyor');
                        }

                        // √úr√ºnleri y√ºkle
                        try {
                            const savedProducts = await window.storage.get('coffee-products');
                            if (savedProducts && savedProducts.value) {
                                setProducts(JSON.parse(savedProducts.value));
                            }
                        } catch (error) {
                            console.log('√úr√ºnler ilk kez y√ºkleniyor');
                        }

                        // Tedarik√ßileri y√ºkle
                        try {
                            const savedSuppliers = await window.storage.get('coffee-suppliers');
                            if (savedSuppliers && savedSuppliers.value) {
                                setSuppliers(JSON.parse(savedSuppliers.value));
                            }
                        } catch (error) {
                            console.log('Tedarik√ßiler ilk kez y√ºkleniyor');
                        }

                        // Sipari≈ü ge√ßmi≈üini y√ºkle
                        try {
                            const savedHistory = await window.storage.get('coffee-order-history');
                            if (savedHistory && savedHistory.value) {
                                setOrderHistory(JSON.parse(savedHistory.value));
                            }
                        } catch (error) {
                            console.log('Ge√ßmi≈ü ilk kez y√ºkleniyor');
                        }
                    } else {
                        console.log('Storage API kullanƒ±lamƒ±yor, varsayƒ±lan veriler y√ºklendi');
                    }
                } catch (error) {
                    console.error('Veri y√ºkleme hatasƒ±:', error);
                }
                
                setTimeout(() => setIsLoading(false), 500);
            };

            const saveCategories = async (newCategories) => {
                setCategories(newCategories);
                if (typeof window.storage !== 'undefined') {
                    try {
                        await window.storage.set('coffee-categories', JSON.stringify(newCategories));
                    } catch (error) {
                        console.error('Kategori kaydetme hatasƒ±:', error);
                    }
                }
            };

            const saveProducts = async (newProducts) => {
                setProducts(newProducts);
                if (typeof window.storage !== 'undefined') {
                    try {
                        await window.storage.set('coffee-products', JSON.stringify(newProducts));
                    } catch (error) {
                        console.error('√úr√ºn kaydetme hatasƒ±:', error);
                    }
                }
            };

            const saveSuppliers = async (newSuppliers) => {
                setSuppliers(newSuppliers);
                if (typeof window.storage !== 'undefined') {
                    try {
                        await window.storage.set('coffee-suppliers', JSON.stringify(newSuppliers));
                    } catch (error) {
                        console.error('Tedarik√ßi kaydetme hatasƒ±:', error);
                    }
                }
            };

            const saveOrderHistory = async (newHistory) => {
                setOrderHistory(newHistory);
                if (typeof window.storage !== 'undefined') {
                    try {
                        await window.storage.set('coffee-order-history', JSON.stringify(newHistory));
                    } catch (error) {
                        console.error('Ge√ßmi≈ü kaydetme hatasƒ±:', error);
                    }
                }
            };

            const showNotification = (message, type = 'success') => {
                const notification = document.createElement('div');
                const bgColor = type === 'success' ? '#22c55e' : type === 'error' ? '#ef4444' : '#f59e0b';
                notification.style.cssText = `position:fixed;top:16px;left:50%;transform:translateX(-50%);background:${bgColor};color:white;padding:12px 24px;border-radius:8px;box-shadow:0 4px 6px rgba(0,0,0,0.1);z-index:9999;font-weight:600;`;
                notification.textContent = message;
                document.body.appendChild(notification);
                setTimeout(() => notification.remove(), 3000);
            };

            const addCategory = () => {
                if (!newCategory.name.trim()) {
                    showNotification('‚ùå Kategori adƒ± girin', 'error');
                    return;
                }
                const newCat = { id: Date.now(), ...newCategory };
                saveCategories([...categories, newCat]);
                setNewCategory({ name: '', icon: 'üì¶' });
                setShowAddCategory(false);
                showNotification('‚úì Kategori eklendi', 'success');
            };

            const addProduct = () => {
                if (!newProduct.name.trim()) {
                    showNotification('‚ùå √úr√ºn adƒ± giriniz', 'error');
                    return;
                }
                if (!selectedCategory) {
                    showNotification('‚ùå L√ºtfen bir kategori se√ßin', 'error');
                    return;
                }
                const newProd = { 
                    id: Date.now(), 
                    categoryId: selectedCategory, 
                    ...newProduct,
                    minStock: parseFloat(newProduct.minStock) || 0,
                    orderStatus: ''
                };
                saveProducts([...products, newProd]);
                setNewProduct({ name: '', unit: 'adet', current: 0, orderQty: 0, minStock: 0, supplier: '', orderStatus: '' });
                setShowAddProduct(false);
                showNotification('‚úì √úr√ºn ba≈üarƒ±yla eklendi', 'success');
            };

            const addSupplier = () => {
                if (!newSupplier.trim()) {
                    showNotification('‚ùå Tedarik√ßi adƒ± girin', 'error');
                    return;
                }
                if (suppliers.includes(newSupplier.trim())) {
                    showNotification('‚ùå Bu tedarik√ßi zaten mevcut', 'error');
                    return;
                }
                saveSuppliers([...suppliers, newSupplier.trim()]);
                setNewSupplier('');
                setShowAddSupplier(false);
                showNotification('‚úì Tedarik√ßi eklendi', 'success');
            };

            const updateProduct = async (id, field, value) => {
                const newProducts = products.map(p => {
                    if (p.id === id) {
                        if (field === 'supplier' || field === 'orderStatus') {
                            return { ...p, [field]: value };
                        } else {
                            const numValue = value === '' ? 0 : parseFloat(value);
                            return { ...p, [field]: isNaN(numValue) ? 0 : numValue };
                        }
                    }
                    return p;
                });
                await saveProducts(newProducts);
            };

            const saveEditedProduct = () => {
                if (!editingProduct.name.trim()) {
                    showNotification('‚ùå √úr√ºn adƒ± bo≈ü olamaz', 'error');
                    return;
                }
                const newProducts = products.map(p => 
                    p.id === editingProduct.id ? editingProduct : p
                );
                saveProducts(newProducts);
                setEditingProduct(null);
                showNotification('‚úì √úr√ºn g√ºncellendi', 'success');
            };

            const deleteProduct = (id) => {
                if (confirm('Bu √ºr√ºn√º silmek istediƒüinize emin misiniz?')) {
                    saveProducts(products.filter(p => p.id !== id));
                    showNotification('‚úì √úr√ºn silindi', 'success');
                }
            };

            const deleteCategory = (id) => {
                const categoryProducts = products.filter(p => p.categoryId === id);
                if (categoryProducts.length > 0) {
                    showNotification('‚ùå Bu kategoride √ºr√ºnler var. √ñnce √ºr√ºnleri silin.', 'error');
                    return;
                }
                if (confirm('Bu kategoriyi silmek istediƒüinize emin misiniz?')) {
                    saveCategories(categories.filter(c => c.id !== id));
                    if (selectedCategory === id) setSelectedCategory(null);
                    showNotification('‚úì Kategori silindi', 'success');
                }
            };

            const deleteSupplier = (supplierName) => {
                const productsWithSupplier = products.filter(p => p.supplier === supplierName);
                if (productsWithSupplier.length > 0) {
                    showNotification(`‚ùå Bu tedarik√ßiye baƒülƒ± ${productsWithSupplier.length} √ºr√ºn var.`, 'error');
                    return;
                }
                if (confirm(`"${supplierName}" tedarik√ßisini silmek istediƒüinize emin misiniz?`)) {
                    saveSuppliers(suppliers.filter(s => s !== supplierName));
                    showNotification('‚úì Tedarik√ßi silindi', 'success');
                }
            };

            const getTotalOrderItems = () => {
                return products.filter(p => p.orderQty > 0).length;
            };

            const getLowStockProducts = () => {
                return products.filter(p => p.current <= p.minStock);
            };

            const confirmAndExportOrder = () => {
                const orderItems = products.filter(p => p.orderQty > 0);
                if (orderItems.length === 0) {
                    showNotification('‚ùå Sipari≈ü listesi bo≈ü', 'error');
                    return;
                }
                setShowOrderConfirm(true);
            };

            const exportOrderList = () => {
                const orderItems = products.filter(p => p.orderQty > 0);
                
                const excelData = [
                    ['Sƒ∞PARƒ∞≈û Lƒ∞STESƒ∞'],
                    ['Tarih:', new Date().toLocaleDateString('tr-TR', { year: 'numeric', month: 'long', day: 'numeric' })],
                    ['Saat:', new Date().toLocaleTimeString('tr-TR')],
                    ['Sipari≈ü Veren:', userName],
                    [],
                    ['Kategori', '√úr√ºn', 'Tedarik√ßi', 'Birim', 'Mevcut Stok', 'Sipari≈ü Miktarƒ±', 'Notlar'],
                    ...orderItems.map(p => {
                        const cat = categories.find(c => c.id === p.categoryId);
                        return [
                            cat?.name || '', 
                            p.name, 
                            p.supplier || '-',
                            p.unit, 
                            p.current, 
                            p.orderQty,
                            ''
                        ];
                    }),
                    [],
                    ['TOPLAM KALEM:', orderItems.length],
                ];

                const ws = XLSX.utils.aoa_to_sheet(excelData);
                ws['!cols'] = [
                    { wch: 25 }, { wch: 30 }, { wch: 20 }, { wch: 10 }, { wch: 15 }, { wch: 18 }, { wch: 30 },
                ];
                ws['!merges'] = [{ s: { r: 0, c: 0 }, e: { r: 0, c: 6 } }];

                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'Sipari≈ü Listesi');
                XLSX.writeFile(wb, `Siparis_${new Date().toLocaleDateString('tr-TR').replace(/\./g, '-')}.xlsx`);
                
                // Sipari≈üleri "Sipari≈ü Verildi" olarak i≈üaretle
                const updatedProducts = products.map(p => 
                    p.orderQty > 0 ? { ...p, orderStatus: 'ordered' } : p
                );
                saveProducts(updatedProducts);

                // Sipari≈ü ge√ßmi≈üine kaydet
                const newHistoryEntry = {
                    id: Date.now(),
                    date: new Date().toISOString(),
                    user: userName,
                    items: orderItems.map(p => ({
                        name: p.name,
                        category: categories.find(c => c.id === p.categoryId)?.name,
                        supplier: p.supplier,
                        quantity: p.orderQty,
                        unit: p.unit
                    }))
                };
                saveOrderHistory([newHistoryEntry, ...orderHistory].slice(0, 50));
                
                setShowOrderConfirm(false);
                showNotification('‚úì Sipari≈ü listesi indirildi', 'success');
            };

            const exportAllProducts = () => {
                const excelData = [
                    ['T√úM √úR√úNLER Lƒ∞STESƒ∞'],
                    ['Tarih:', new Date().toLocaleDateString('tr-TR')],
                    [],
                    ['Kategori', '√úr√ºn', 'Tedarik√ßi', 'Birim', 'Mevcut Stok', 'Min. Stok', 'Durum'],
                    ...products.map(p => {
                        const cat = categories.find(c => c.id === p.categoryId);
                        const status = p.current <= p.minStock ? 'D√ú≈û√úK' : 'ƒ∞Yƒ∞';
                        return [
                            cat?.name || '', p.name, p.supplier || '-', p.unit, p.current, p.minStock, status
                        ];
                    }),
                ];

                const ws = XLSX.utils.aoa_to_sheet(excelData);
                ws['!cols'] = [{ wch: 25 }, { wch: 30 }, { wch: 20 }, { wch: 10 }, { wch: 15 }, { wch: 15 }, { wch: 12 }];
                ws['!merges'] = [{ s: { r: 0, c: 0 }, e: { r: 0, c: 6 } }];

                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'T√ºm √úr√ºnler');
                XLSX.writeFile(wb, `Tum_Urunler_${new Date().toLocaleDateString('tr-TR').replace(/\./g, '-')}.xlsx`);
                showNotification('‚úì T√ºm √ºr√ºnler indirildi', 'success');
            };

            const clearAllOrders = () => {
                if (confirm('T√ºm sipari≈ü miktarlarƒ±nƒ± sƒ±fƒ±rlamak istediƒüinize emin misiniz?')) {
                    const newProducts = products.map(p => ({ ...p, orderQty: 0, orderStatus: '' }));
                    saveProducts(newProducts);
                    showNotification('‚úì Sipari≈ü listesi temizlendi', 'success');
                }
            };

            if (isLoading) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center">
                        <div className="text-center">
                            <div className="text-6xl mb-6">‚òï</div>
                            <Loader />
                            <p className="text-white text-xl font-semibold mt-6">Y√ºkleniyor...</p>
                        </div>
                    </div>
                );
            }

            if (showNamePrompt && !userName) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-sm w-full">
                            <div className="text-center mb-6">
                                <div className="text-6xl mb-4">‚òï</div>
                                <h1 className="text-2xl font-bold text-amber-900">Stok Y√∂netimi</h1>
                                <p className="text-gray-600 mt-2">Ho≈ü geldiniz!</p>
                            </div>
                            <input
                                type="text"
                                placeholder="ƒ∞sminizi girin"
                                className="w-full px-4 py-3 border-2 border-amber-200 rounded-lg text-lg focus:border-amber-500 focus:outline-none"
                                onKeyPress={(e) => {
                                    if (e.key === 'Enter' && e.target.value.trim()) {
                                        setUserName(e.target.value.trim());
                                        setShowNamePrompt(false);
                                    }
                                }}
                                autoFocus
                            />
                            <button
                                onClick={(e) => {
                                    const input = e.target.previousSibling;
                                    if (input.value.trim()) {
                                        setUserName(input.value.trim());
                                        setShowNamePrompt(false);
                                    }
                                }}
                                className="w-full mt-4 bg-amber-600 text-white py-3 rounded-lg font-semibold text-lg hover:bg-amber-700 active:bg-amber-800"
                            >
                                Ba≈üla
                            </button>
                        </div>
                    </div>
                );
            }

            const filteredProducts = products.filter(p => {
                const matchesCategory = selectedCategory ? p.categoryId === selectedCategory : true;
                const matchesSearch = p.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                                     (p.supplier && p.supplier.toLowerCase().includes(searchQuery.toLowerCase()));
                return matchesCategory && matchesSearch;
            });

            const lowStockProducts = getLowStockProducts();

            return (
                <div className="min-h-screen bg-gray-50 pb-24">
                    <div className="bg-gradient-to-r from-amber-600 to-orange-600 text-white p-4 shadow-lg sticky top-0 z-40">
                        <div className="flex items-center justify-between">
                            <div>
                                <h1 className="text-xl font-bold">‚òï Stok Y√∂netimi</h1>
                                <p className="text-sm text-amber-100">{userName}</p>
                            </div>
                            <div className="flex gap-2">
                                <button
                                    onClick={() => setShowHistory(true)}
                                    className="p-2 hover:bg-white/20 rounded-lg relative"
                                >
                                    <History />
                                    {orderHistory.length > 0 && (
                                        <span className="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                                            {orderHistory.length}
                                        </span>
                                    )}
                                </button>
                                <button
                                    onClick={() => setShowMenu(!showMenu)}
                                    className="p-2 hover:bg-white/20 rounded-lg"
                                >
                                    {showMenu ? <X /> : <Menu />}
                                </button>
                            </div>
                        </div>
                    </div>

                    {lowStockProducts.length > 0 && (
                        <div className="bg-red-500 text-white p-4">
                            <div className="flex items-center gap-2 mb-2">
                                <AlertCircle />
                                <span className="font-bold">D√ú≈û√úK STOK UYARISI!</span>
                            </div>
                            <p className="text-sm">
                                {lowStockProducts.length} √ºr√ºn minimum stok seviyesinde: {lowStockProducts.slice(0, 3).map(p => p.name).join(', ')}
                                {lowStockProducts.length > 3 && ` ve ${lowStockProducts.length - 3} √ºr√ºn daha...`}
                            </p>
                        </div>
                    )}

                    {showOrderConfirm && (
                        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-md w-full">
                                <div className="text-center mb-6">
                                    <div className="w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <ShoppingCart />
                                    </div>
                                    <h3 className="text-2xl font-bold text-gray-800">Sipari≈ü Onayƒ±</h3>
                                    <p className="text-gray-600 mt-2">Sipari≈ü listesini indirmek istediƒüinize emin misiniz?</p>
                                </div>

                                <div className="bg-gray-50 rounded-lg p-4 mb-6">
                                    <p className="text-sm text-gray-700 mb-2">
                                        <strong>{getTotalOrderItems()} kalem</strong> sipari≈ü verilecek
                                    </p>
                                    <div className="max-h-40 overflow-y-auto space-y-1">
                                        {products.filter(p => p.orderQty > 0).map(p => (
                                            <div key={p.id} className="text-xs flex justify-between">
                                                <span>{p.name}</span>
                                                <span className="font-semibold">{p.orderQty} {p.unit}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <div className="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-6">
                                    <div className="flex items-start gap-2">
                                        <Clock />
                                        <div className="text-sm text-blue-800">
                                            <strong>Not:</strong> Sipari≈ü verildikten sonra √ºr√ºnler <strong>"Sipari≈ü Verildi"</strong> olarak i≈üaretlenecektir. Stok miktarlarƒ± otomatik g√ºncellenmeyecektir.
                                        </div>
                                    </div>
                                </div>

                                <div className="flex gap-3">
                                    <button
                                        onClick={() => setShowOrderConfirm(false)}
                                        className="flex-1 px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300"
                                    >
                                        ƒ∞ptal
                                    </button>
                                    <button
                                        onClick={exportOrderList}
                                        className="flex-1 px-6 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 flex items-center justify-center gap-2"
                                    >
                                        <Download size={20} />
                                        ƒ∞ndir
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showMenu && (
                        <div className="fixed inset-0 bg-black/50 z-50" onClick={() => setShowMenu(false)}>
                            <div className="absolute right-0 top-0 h-full w-80 bg-white shadow-xl p-4 overflow-y-auto" onClick={(e) => e.stopPropagation()}>
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="font-bold text-lg">Men√º</h3>
                                    <button onClick={() => setShowMenu(false)}><X /></button>
                                </div>
                                
                                <div className="mb-6">
                                    <h4 className="font-semibold mb-3 text-gray-700">üìÅ Kategoriler</h4>
                                    {categories.map(cat => (
                                        <div key={cat.id} className="flex items-center justify-between p-2 hover:bg-gray-50 rounded">
                                            <span>{cat.icon} {cat.name}</span>
                                            <button onClick={() => deleteCategory(cat.id)} className="text-red-600 p-1">
                                                <Trash2 size={18} />
                                            </button>
                                        </div>
                                    ))}
                                    <button
                                        onClick={() => { setShowAddCategory(true); setShowMenu(false); }}
                                        className="w-full mt-2 flex items-center justify-center gap-2 p-2 bg-amber-100 text-amber-700 rounded-lg"
                                    >
                                        <Plus size={18} />
                                        Kategori Ekle
                                    </button>
                                </div>

                                <div className="mb-6">
                                    <h4 className="font-semibold mb-3 text-gray-700 flex items-center gap-2">
                                        <Truck size={18} />
                                        Tedarik√ßiler
                                    </h4>
                                    <div className="max-h-32 overflow-y-auto mb-2">
                                        {suppliers.slice(0, 3).map((sup, idx) => (
                                            <div key={idx} className="p-2 bg-gray-50 rounded mb-1 text-sm">
                                                {sup}
                                            </div>
                                        ))}
                                        {suppliers.length > 3 && (
                                            <p className="text-xs text-gray-500 italic pl-2">+{suppliers.length - 3} tedarik√ßi daha...</p>
                                        )}
                                    </div>
                                    <div className="flex gap-2">
                                        <button
                                            onClick={() => { setShowAddSupplier(true); setShowMenu(false); }}
                                            className="flex-1 flex items-center justify-center gap-2 p-2 bg-blue-100 text-blue-700 rounded-lg text-sm"
                                        >
                                            <Plus size={16} />
                                            Ekle
                                        </button>
                                        <button
                                            onClick={() => { setShowManageSuppliers(true); setShowMenu(false); }}
                                            className="flex-1 flex items-center justify-center gap-2 p-2 bg-gray-100 text-gray-700 rounded-lg text-sm"
                                        >
                                            <Edit2 size={16} />
                                            D√ºzenle
                                        </button>
                                    </div>
                                </div>

                                <div className="space-y-2 border-t pt-4">
                                    <button
                                        onClick={() => { exportAllProducts(); setShowMenu(false); }}
                                        className="w-full flex items-center gap-3 p-3 hover:bg-gray-100 rounded-lg"
                                    >
                                        <Download size={20} />
                                        <span>T√ºm √úr√ºnleri ƒ∞ndir</span>
                                    </button>
                                    <button
                                        onClick={() => { confirmAndExportOrder(); setShowMenu(false); }}
                                        className="w-full flex items-center gap-3 p-3 hover:bg-gray-100 rounded-lg"
                                    >
                                        <ShoppingCart size={20} />
                                        <span>Sipari≈ü Listesini ƒ∞ndir</span>
                                    </button>
                                    <button
                                        onClick={() => { clearAllOrders(); setShowMenu(false); }}
                                        className="w-full flex items-center gap-3 p-3 hover:bg-gray-100 rounded-lg text-red-600"
                                    >
                                        <Trash2 size={20} />
                                        <span>Sipari≈üleri Temizle</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showAddCategory && (
                        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full">
                                <h3 className="text-xl font-bold mb-4">Yeni Kategori</h3>
                                <input
                                    type="text"
                                    placeholder="Kategori adƒ±"
                                    value={newCategory.name}
                                    onChange={(e) => setNewCategory({ ...newCategory, name: e.target.value })}
                                    className="w-full px-4 py-3 border-2 rounded-lg mb-3"
                                />
                                <input
                                    type="text"
                                    placeholder="Emoji (√∂rn: üç∞)"
                                    value={newCategory.icon}
                                    onChange={(e) => setNewCategory({ ...newCategory, icon: e.target.value })}
                                    className="w-full px-4 py-3 border-2 rounded-lg mb-4"
                                />
                                <div className="flex gap-2">
                                    <button onClick={addCategory} className="flex-1 bg-amber-600 text-white py-3 rounded-lg font-semibold">
                                        Ekle
                                    </button>
                                    <button onClick={() => setShowAddCategory(false)} className="flex-1 bg-gray-200 py-3 rounded-lg font-semibold">
                                        ƒ∞ptal
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showAddSupplier && (
                        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full">
                                <h3 className="text-xl font-bold mb-4">Yeni Tedarik√ßi</h3>
                                <input
                                    type="text"
                                    placeholder="Tedarik√ßi adƒ±"
                                    value={newSupplier}
                                    onChange={(e) => setNewSupplier(e.target.value)}
                                    className="w-full px-4 py-3 border-2 rounded-lg mb-4"
                                />
                                <div className="flex gap-2">
                                    <button onClick={addSupplier} className="flex-1 bg-blue-600 text-white py-3 rounded-lg font-semibold">
                                        Ekle
                                    </button>
                                    <button onClick={() => setShowAddSupplier(false)} className="flex-1 bg-gray-200 py-3 rounded-lg font-semibold">
                                        ƒ∞ptal
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showManageSuppliers && (
                        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-md w-full max-h-[80vh] overflow-y-auto">
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="text-xl font-bold">üöö Tedarik√ßi Y√∂netimi</h3>
                                    <button onClick={() => setShowManageSuppliers(false)}><X /></button>
                                </div>
                                
                                {suppliers.length === 0 ? (
                                    <div className="text-center py-8 text-gray-500">
                                        <p>Hen√ºz tedarik√ßi yok</p>
                                        <button
                                            onClick={() => { setShowManageSuppliers(false); setShowAddSupplier(true); }}
                                            className="mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg font-semibold"
                                        >
                                            ƒ∞lk Tedarik√ßiyi Ekle
                                        </button>
                                    </div>
                                ) : (
                                    <div className="space-y-2">
                                        {suppliers.map((sup, idx) => {
                                            const productCount = products.filter(p => p.supplier === sup).length;
                                            return (
                                                <div key={idx} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                    <div>
                                                        <p className="font-semibold">{sup}</p>
                                                        <p className="text-xs text-gray-500">{productCount} √ºr√ºn</p>
                                                    </div>
                                                    <button
                                                        onClick={() => deleteSupplier(sup)}
                                                        className="text-red-600 p-2 hover:bg-red-50 rounded"
                                                    >
                                                        <Trash2 size={18} />
                                                    </button>
                                                </div>
                                            );
                                        })}
                                        <button
                                            onClick={() => { setShowManageSuppliers(false); setShowAddSupplier(true); }}
                                            className="w-full mt-4 flex items-center justify-center gap-2 p-3 bg-blue-100 text-blue-700 rounded-lg font-semibold"
                                        >
                                            <Plus size={18} />
                                            Yeni Tedarik√ßi Ekle
                                        </button>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {showAddProduct && (
                        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 overflow-y-auto">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full my-8">
                                <h3 className="text-xl font-bold mb-4">Yeni √úr√ºn Ekle</h3>
                                
                                <label className="block text-sm font-semibold text-gray-700 mb-2">Kategori Se√ßin *</label>
                                <select
                                    value={selectedCategory || ''}
                                    onChange={(e) => setSelectedCategory(Number(e.target.value))}
                                    className="w-full px-4 py-3 border-2 border-amber-200 rounded-lg mb-3 font-semibold"
                                >
                                    <option value="">Kategori se√ßiniz</option>
                                    {categories.map(cat => (
                                        <option key={cat.id} value={cat.id}>
                                            {cat.icon} {cat.name}
                                        </option>
                                    ))}
                                </select>

                                <label className="block text-sm font-semibold text-gray-700 mb-2">√úr√ºn Adƒ± *</label>
                                <input
                                    type="text"
                                    placeholder="√ñrn: Espresso √áekirdeƒüi"
                                    value={newProduct.name}
                                    onChange={(e) => setNewProduct({ ...newProduct, name: e.target.value })}
                                    className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg mb-3"
                                />

                                <label className="block text-sm font-semibold text-gray-700 mb-2">Tedarik√ßi</label>
                                <select
                                    value={newProduct.supplier}
                                    onChange={(e) => setNewProduct({ ...newProduct, supplier: e.target.value })}
                                    className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg mb-3"
                                >
                                    <option value="">Se√ßiniz...</option>
                                    {suppliers.map((sup, idx) => (
                                        <option key={idx} value={sup}>{sup}</option>
                                    ))}
                                </select>

                                <label className="block text-sm font-semibold text-gray-700 mb-2">Birim *</label>
                                <select
                                    value={newProduct.unit}
                                    onChange={(e) => setNewProduct({ ...newProduct, unit: e.target.value })}
                                    className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg mb-3"
                                >
                                    <option value="adet">Adet</option>
                                    <option value="kg">Kilogram (kg)</option>
                                    <option value="gram">Gram (gr)</option>
                                    <option value="litre">Litre</option>
                                    <option value="ml">Mililitre (ml)</option>
                                    <option value="paket">Paket</option>
                                    <option value="≈üi≈üe">≈ûi≈üe</option>
                                    <option value="kutu">Kutu</option>
                                    <option value="koli">Koli</option>
                                </select>

                                <div className="grid grid-cols-2 gap-3 mb-4">
                                    <div>
                                        <label className="block text-sm font-semibold text-gray-700 mb-2">Mevcut Stok</label>
                                        <input
                                            type="number"
                                            placeholder="0"
                                            value={newProduct.current}
                                            onChange={(e) => setNewProduct({ ...newProduct, current: e.target.value })}
                                            className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-semibold text-gray-700 mb-2">Min. Stok</label>
                                        <input
                                            type="number"
                                            placeholder="0"
                                            value={newProduct.minStock}
                                            onChange={(e) => setNewProduct({ ...newProduct, minStock: e.target.value })}
                                            className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg"
                                        />
                                    </div>
                                </div>

                                <div className="flex gap-2">
                                    <button onClick={addProduct} className="flex-1 bg-amber-600 text-white py-3 rounded-lg font-semibold">
                                        Ekle
                                    </button>
                                    <button onClick={() => setShowAddProduct(false)} className="flex-1 bg-gray-200 py-3 rounded-lg font-semibold">
                                        ƒ∞ptal
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {editingProduct && (
                        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 overflow-y-auto">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full my-8">
                                <h3 className="text-xl font-bold mb-4">√úr√ºn D√ºzenle</h3>
                                
                                <label className="block text-sm font-semibold text-gray-700 mb-2">Kategori</label>
                                <select
                                    value={editingProduct.categoryId}
                                    onChange={(e) => setEditingProduct({ ...editingProduct, categoryId: Number(e.target.value) })}
                                    className="w-full px-4 py-3 border-2 rounded-lg mb-3"
                                >
                                    {categories.map(cat => (
                                        <option key={cat.id} value={cat.id}>
                                            {cat.icon} {cat.name}
                                        </option>
                                    ))}
                                </select>

                                <label className="block text-sm font-semibold text-gray-700 mb-2">√úr√ºn Adƒ±</label>
                                <input
                                    type="text"
                                    value={editingProduct.name}
                                    onChange={(e) => setEditingProduct({ ...editingProduct, name: e.target.value })}
                                    className="w-full px-4 py-3 border-2 rounded-lg mb-3"
                                />

                                <label className="block text-sm font-semibold text-gray-700 mb-2">Birim</label>
                                <select
                                    value={editingProduct.unit}
                                    onChange={(e) => setEditingProduct({ ...editingProduct, unit: e.target.value })}
                                    className="w-full px-4 py-3 border-2 rounded-lg mb-3"
                                >
                                    <option value="adet">Adet</option>
                                    <option value="kg">Kilogram (kg)</option>
                                    <option value="gram">Gram (gr)</option>
                                    <option value="litre">Litre</option>
                                    <option value="ml">Mililitre (ml)</option>
                                    <option value="paket">Paket</option>
                                    <option value="≈üi≈üe">≈ûi≈üe</option>
                                    <option value="kutu">Kutu</option>
                                    <option value="koli">Koli</option>
                                </select>

                                <label className="block text-sm font-semibold text-gray-700 mb-2">Tedarik√ßi</label>
                                <select
                                    value={editingProduct.supplier || ''}
                                    onChange={(e) => setEditingProduct({ ...editingProduct, supplier: e.target.value })}
                                    className="w-full px-4 py-3 border-2 rounded-lg mb-3"
                                >
                                    <option value="">Se√ßiniz...</option>
                                    {suppliers.map((sup, idx) => (
                                        <option key={idx} value={sup}>{sup}</option>
                                    ))}
                                </select>

                                <label className="block text-sm font-semibold text-gray-700 mb-2">Minimum Stok</label>
                                <input
                                    type="number"
                                    value={editingProduct.minStock}
                                    onChange={(e) => setEditingProduct({ ...editingProduct, minStock: e.target.value })}
                                    className="w-full px-4 py-3 border-2 rounded-lg mb-4"
                                />

                                <div className="flex gap-2">
                                    <button onClick={saveEditedProduct} className="flex-1 bg-green-600 text-white py-3 rounded-lg font-semibold">
                                        Kaydet
                                    </button>
                                    <button onClick={() => setEditingProduct(null)} className="flex-1 bg-gray-200 py-3 rounded-lg font-semibold">
                                        ƒ∞ptal
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showHistory && (
                        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto">
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="text-xl font-bold">üìã Sipari≈ü Ge√ßmi≈üi</h3>
                                    <button onClick={() => setShowHistory(false)}><X /></button>
                                </div>
                                
                                {orderHistory.length === 0 ? (
                                    <div className="text-center py-12 text-gray-500">
                                        <div className="mx-auto mb-4"><History size={48} /></div>
                                        <p>Hen√ºz sipari≈ü kaydƒ± yok</p>
                                    </div>
                                ) : (
                                    <div className="space-y-4">
                                        {orderHistory.map(order => (
                                            <div key={order.id} className="bg-gray-50 rounded-lg p-4">
                                                <div className="flex justify-between items-start mb-3">
                                                    <div>
                                                        <p className="font-bold text-gray-800">{order.user}</p>
                                                        <p className="text-sm text-gray-600">
                                                            {new Date(order.date).toLocaleDateString('tr-TR', { 
                                                                year: 'numeric', 
                                                                month: 'long', 
                                                                day: 'numeric',
                                                                hour: '2-digit',
                                                                minute: '2-digit'
                                                            })}
                                                        </p>
                                                    </div>
                                                    <span className="bg-amber-100 text-amber-700 px-3 py-1 rounded-full text-sm font-semibold">
                                                        {order.items.length} Kalem
                                                    </span>
                                                </div>
                                                <div className="space-y-1">
                                                    {order.items.slice(0, 5).map((item, idx) => (
                                                        <div key={idx} className="text-sm text-gray-700 flex justify-between">
                                                            <span>{item.name}</span>
                                                            <span className="font-semibold">{item.quantity} {item.unit}</span>
                                                        </div>
                                                    ))}
                                                    {order.items.length > 5 && (
                                                        <p className="text-sm text-gray-500 italic">
                                                            +{order.items.length - 5} √ºr√ºn daha...
                                                        </p>
                                                    )}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    <div className="p-4">
                        <div className="relative mb-4">
                            <input
                                type="text"
                                placeholder="√úr√ºn veya tedarik√ßi ara..."
                                value={searchQuery}
                                onChange={(e) => setSearchQuery(e.target.value)}
                                className="w-full pl-12 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:border-amber-500 focus:outline-none"
                            />
                            <div className="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400">
                                <Search />
                            </div>
                        </div>
                    </div>

                    <div className="px-4 overflow-x-auto pb-2">
                        <div className="flex gap-2">
                            <button
                                onClick={() => setSelectedCategory(null)}
                                className={`px-4 py-2 rounded-full font-semibold whitespace-nowrap ${
                                    selectedCategory === null ? 'bg-amber-600 text-white' : 'bg-white text-gray-700'
                                }`}
                            >
                                T√ºm√º ({products.length})
                            </button>
                            {categories.map(cat => {
                                const count = products.filter(p => p.categoryId === cat.id).length;
                                return (
                                    <button
                                        key={cat.id}
                                        onClick={() => setSelectedCategory(cat.id)}
                                        className={`px-4 py-2 rounded-full font-semibold whitespace-nowrap ${
                                            selectedCategory === cat.id ? 'bg-amber-600 text-white' : 'bg-white text-gray-700'
                                        }`}
                                    >
                                        {cat.icon} {cat.name} ({count})
                                    </button>
                                );
                            })}
                        </div>
                    </div>

                    <div className="px-4 space-y-3 pb-4 mt-4">
                        {filteredProducts.length === 0 ? (
                            <div className="text-center py-12 bg-white rounded-xl">
                                <div className="text-6xl mb-4">üîç</div>
                                <p className="text-gray-500 font-semibold">
                                    {searchQuery ? '√úr√ºn bulunamadƒ±' : 'Bu kategoride hen√ºz √ºr√ºn yok'}
                                </p>
                                {!searchQuery && (
                                    <button
                                        onClick={() => setShowAddProduct(true)}
                                        className="mt-4 px-6 py-2 bg-amber-600 text-white rounded-lg font-semibold"
                                    >
                                        ƒ∞lk √úr√ºn√º Ekle
                                    </button>
                                )}
                            </div>
                        ) : (
                            filteredProducts.map(product => {
                                const isLowStock = product.current <= product.minStock;
                                const isOrdered = product.orderStatus === 'ordered';
                                return (
                                    <div key={product.id} className={`bg-white rounded-xl shadow-md p-4 ${isLowStock ? 'border-l-4 border-red-500' : ''}`}>
                                        <div className="flex justify-between items-start mb-3">
                                            <div className="flex-1">
                                                <h3 className="font-bold text-gray-800 flex items-center gap-2 flex-wrap">
                                                    {product.name}
                                                    {isLowStock && (
                                                        <span className="bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full">
                                                            D√ú≈û√úK
                                                        </span>
                                                    )}
                                                    {isOrdered && (
                                                        <span className="bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded-full flex items-center gap-1">
                                                            <Clock />
                                                            Sipari≈ü Verildi
                                                        </span>
                                                    )}
                                                </h3>
                                                <p className="text-xs text-gray-500 mt-1">
                                                    {categories.find(c => c.id === product.categoryId)?.icon} {categories.find(c => c.id === product.categoryId)?.name || 'Kategori yok'}
                                                    {product.supplier && ` ‚Ä¢ ${product.supplier}`}
                                                </p>
                                                <p className="text-xs text-gray-400 mt-1">
                                                    Min. Stok: {product.minStock} {product.unit}
                                                </p>
                                            </div>
                                            <div className="flex gap-1">
                                                <button 
                                                    onClick={() => setEditingProduct(product)} 
                                                    className="text-blue-600 p-1"
                                                >
                                                    <Edit2 size={18} />
                                                </button>
                                                <button 
                                                    onClick={() => deleteProduct(product.id)} 
                                                    className="text-red-600 p-1"
                                                >
                                                    <Trash2 size={18} />
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <div className="grid grid-cols-2 gap-3">
                                            <div>
                                                <label className="text-xs text-gray-600 mb-1 block font-semibold">Mevcut Stok</label>
                                                <div className="flex items-center gap-2">
                                                    <input
                                                        type="number"
                                                        value={product.current}
                                                        onChange={(e) => updateProduct(product.id, 'current', e.target.value)}
                                                        className={`w-full px-3 py-2 border-2 rounded-lg font-bold text-lg focus:outline-none ${
                                                            isLowStock ? 'border-red-300 bg-red-50 focus:border-red-500' : 'border-gray-300 focus:border-amber-500'
                                                        }`}
                                                        min="0"
                                                        step="0.1"
                                                    />
                                                    <span className="text-gray-600 text-sm font-semibold whitespace-nowrap">{product.unit}</span>
                                                </div>
                                            </div>
                                            
                                            <div>
                                                <label className="text-xs text-orange-600 mb-1 block font-semibold">Sipari≈ü Ver</label>
                                                <div className="flex items-center gap-2">
                                                    <input
                                                        type="number"
                                                        value={product.orderQty || ''}
                                                        onChange={(e) => {
                                                            const val = e.target.value;
                                                            updateProduct(product.id, 'orderQty', val);
                                                            if (parseFloat(val) > 0) {
                                                                updateProduct(product.id, 'orderStatus', '');
                                                            }
                                                        }}
                                                        onFocus={(e) => {
                                                            if (e.target.value === '0') {
                                                                e.target.value = '';
                                                            }
                                                        }}
                                                        onBlur={(e) => {
                                                            if (e.target.value === '') {
                                                                updateProduct(product.id, 'orderQty', 0);
                                                            }
                                                        }}
                                                        className="w-full px-3 py-2 border-2 rounded-lg font-bold text-lg bg-orange-50 border-orange-300 focus:border-orange-500 focus:outline-none"
                                                        min="0"
                                                        step="0.1"
                                                        placeholder="0"
                                                    />
                                                    <span className="text-gray-600 text-sm font-semibold whitespace-nowrap">{product.unit}</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                );
                            })
                        )}
                    </div>

                    <div className="fixed bottom-6 right-6 z-50 flex flex-col gap-3 items-end">
                        {getTotalOrderItems() > 0 && (
                            <button
                                onClick={confirmAndExportOrder}
                                className="bg-green-600 text-white p-4 rounded-full shadow-2xl flex items-center gap-2 hover:bg-green-700 active:bg-green-800"
                            >
                                <ShoppingCart />
                                <span className="bg-white text-green-600 px-2 py-1 rounded-full text-sm font-bold">
                                    {getTotalOrderItems()}
                                </span>
                            </button>
                        )}
                        <button
                            onClick={() => setShowAddProduct(true)}
                            className="bg-amber-600 text-white p-5 rounded-full shadow-2xl hover:bg-amber-700 active:bg-amber-800"
                        >
                            <Plus />
                        </button>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<CoffeeInventory />, document.getElementById('root'));
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>â˜• Kahve Stok Takip</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * { -webkit-tap-highlight-color: transparent; }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .spinner { animation: spin 1s linear infinite; }
        .dark { color-scheme: dark; }
        .dark body { background: #111827; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icons
        const Plus = ({ size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>;
        const Minus = ({ size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line></svg>;
        const ShoppingCart = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>;
        const Menu = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>;
        const X = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>;
        const Trash2 = ({ size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>;
        const Search = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>;
        const AlertCircle = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>;
        const History = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v5h5"></path><path d="M3.05 13A9 9 0 1 0 6 5.3L3 8"></path><path d="M12 7v5l4 2"></path></svg>;
        const Download = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>;
        const Edit2 = ({ size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>;
        const Truck = ({ size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M1 3h15v13H1z"></path><path d="M16 8h4l3 3v5h-7V8z"></path><circle cx="5.5" cy="18.5" r="2.5"></circle><circle cx="18.5" cy="18.5" r="2.5"></circle></svg>;
        const Loader = () => <svg className="spinner" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="white" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="2" x2="12" y2="6"></line><line x1="12" y1="18" x2="12" y2="22"></line><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line><line x1="2" y1="12" x2="6" y2="12"></line><line x1="18" y1="12" x2="22" y2="12"></line><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line></svg>;
        const Clock = () => <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>;
        const Moon = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>;
        const Sun = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>;
        const BarChart = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="20" x2="12" y2="10"></line><line x1="18" y1="20" x2="18" y2="4"></line><line x1="6" y1="20" x2="6" y2="16"></line></svg>;
        const ArrowUpDown = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m21 16-4 4-4-4"></path><path d="M17 20V4"></path><path d="m3 8 4-4 4 4"></path><path d="M7 4v16"></path></svg>;

        const CoffeeInventory = () => {
            const defaultCategories = [
                { id: 1, name: 'Kahve & Ã‡ekirdek', icon: 'â˜•' },
                { id: 2, name: 'SÃ¼t & Krema', icon: 'ðŸ¥›' },
                { id: 3, name: 'Åžeker & TatlandÄ±rÄ±cÄ±', icon: 'ðŸ¬' },
                { id: 4, name: 'Bardak & Kapak', icon: 'ðŸ¥¤' },
                { id: 5, name: 'Sos & Åžurup', icon: 'ðŸ¯' },
                { id: 6, name: 'DiÄŸer Malzemeler', icon: 'ðŸ“¦' },
            ];

            const defaultProducts = [
                { id: 1, categoryId: 1, name: 'Espresso Ã‡ekirdeÄŸi', unit: 'kg', current: 5, orderQty: 0, minStock: 3, supplier: 'Kahve DÃ¼nyasÄ±', orderStatus: '' },
                { id: 2, categoryId: 1, name: 'Filter Kahve Ã‡ekirdeÄŸi', unit: 'kg', current: 3, orderQty: 0, minStock: 2, supplier: 'Kahve DÃ¼nyasÄ±', orderStatus: '' },
                { id: 3, categoryId: 2, name: 'Tam YaÄŸlÄ± SÃ¼t', unit: 'litre', current: 15, orderQty: 0, minStock: 10, supplier: 'PÄ±nar', orderStatus: '' },
                { id: 4, categoryId: 2, name: 'Laktoz Free SÃ¼t', unit: 'litre', current: 5, orderQty: 0, minStock: 5, supplier: 'PÄ±nar', orderStatus: '' },
                { id: 5, categoryId: 3, name: 'Åžeker Paketi', unit: 'adet', current: 200, orderQty: 0, minStock: 100, supplier: 'TÃ¼rk Åžeker', orderStatus: '' },
                { id: 6, categoryId: 3, name: 'Stevia', unit: 'adet', current: 50, orderQty: 0, minStock: 30, supplier: 'Metro', orderStatus: '' },
                { id: 7, categoryId: 4, name: 'KÃ¼Ã§Ã¼k Bardak', unit: 'adet', current: 150, orderQty: 0, minStock: 100, supplier: 'KaÄŸÄ±t PazarÄ±', orderStatus: '' },
                { id: 8, categoryId: 4, name: 'BÃ¼yÃ¼k Bardak', unit: 'adet', current: 120, orderQty: 0, minStock: 80, supplier: 'KaÄŸÄ±t PazarÄ±', orderStatus: '' },
                { id: 9, categoryId: 4, name: 'Kapak', unit: 'adet', current: 180, orderQty: 0, minStock: 120, supplier: 'KaÄŸÄ±t PazarÄ±', orderStatus: '' },
                { id: 10, categoryId: 5, name: 'Ã‡ikolata Sosu', unit: 'ÅŸiÅŸe', current: 2, orderQty: 0, minStock: 2, supplier: 'Metro', orderStatus: '' },
            ];

            const [categories, setCategories] = useState(defaultCategories);
            const [products, setProducts] = useState(defaultProducts);
            const [suppliers, setSuppliers] = useState(['Kahve DÃ¼nyasÄ±', 'PÄ±nar', 'TÃ¼rk Åžeker', 'Metro', 'KaÄŸÄ±t PazarÄ±']);
            const [orderHistory, setOrderHistory] = useState([]);
            const [selectedCategory, setSelectedCategory] = useState(null);
            const [searchQuery, setSearchQuery] = useState('');
            const [showMenu, setShowMenu] = useState(false);
            const [showAddCategory, setShowAddCategory] = useState(false);
            const [showAddProduct, setShowAddProduct] = useState(false);
            const [showAddSupplier, setShowAddSupplier] = useState(false);
            const [showManageSuppliers, setShowManageSuppliers] = useState(false);
            const [showHistory, setShowHistory] = useState(false);
            const [showOrderConfirm, setShowOrderConfirm] = useState(false);
            const [showStats, setShowStats] = useState(false);
            const [editingProduct, setEditingProduct] = useState(null);
            const [newCategory, setNewCategory] = useState({ name: '', icon: 'ðŸ“¦' });
            const [newProduct, setNewProduct] = useState({ name: '', unit: 'adet', current: 0, orderQty: 0, minStock: 0, supplier: '', orderStatus: '' });
            const [newSupplier, setNewSupplier] = useState('');
            const [userName, setUserName] = useState('');
            const [showNamePrompt, setShowNamePrompt] = useState(true);
            const [isLoading, setIsLoading] = useState(true);
            const [darkMode, setDarkMode] = useState(false);
            const [sortBy, setSortBy] = useState('name'); // name, stock, lowStock

            useEffect(() => {
                loadData();
                // Dark mode kontrolÃ¼
                const savedDarkMode = localStorage.getItem('darkMode');
                if (savedDarkMode === 'true') {
                    setDarkMode(true);
                    document.documentElement.classList.add('dark');
                }
            }, []);

            const toggleDarkMode = () => {
                setDarkMode(!darkMode);
                document.documentElement.classList.toggle('dark');
                localStorage.setItem('darkMode', !darkMode);
            };

            const loadData = async () => {
                setIsLoading(true);
                
                try {
                    if (typeof window !== 'undefined' && window.storage) {
                        try {
                            const savedCategories = await window.storage.get('coffee-categories');
                            if (savedCategories && savedCategories.value) {
                                setCategories(JSON.parse(savedCategories.value));
                            }
                        } catch (error) {
                            console.log('Kategoriler ilk kez yÃ¼kleniyor');
                        }

                        try {
                            const savedProducts = await window.storage.get('coffee-products');
                            if (savedProducts && savedProducts.value) {
                                setProducts(JSON.parse(savedProducts.value));
                            }
                        } catch (error) {
                            console.log('ÃœrÃ¼nler ilk kez yÃ¼kleniyor');
                        }

                        try {
                            const savedSuppliers = await window.storage.get('coffee-suppliers');
                            if (savedSuppliers && savedSuppliers.value) {
                                setSuppliers(JSON.parse(savedSuppliers.value));
                            }
                        } catch (error) {
                            console.log('TedarikÃ§iler ilk kez yÃ¼kleniyor');
                        }

                        try {
                            const savedHistory = await window.storage.get('coffee-order-history');
                            if (savedHistory && savedHistory.value) {
                                setOrderHistory(JSON.parse(savedHistory.value));
                            }
                        } catch (error) {
                            console.log('GeÃ§miÅŸ ilk kez yÃ¼kleniyor');
                        }
                    }
                } catch (error) {
                    console.error('Veri yÃ¼kleme hatasÄ±:', error);
                }
                
                setTimeout(() => setIsLoading(false), 500);
            };

            const saveCategories = (newCategories) => {
                setCategories(newCategories);
                if (typeof window.storage !== 'undefined') {
                    try {
                        window.storage.set('coffee-categories', JSON.stringify(newCategories));
                    } catch (error) {
                        console.error('Kategori kaydetme hatasÄ±:', error);
                    }
                }
            };

            const saveProducts = (newProducts) => {
                setProducts(newProducts);
                if (typeof window.storage !== 'undefined') {
                    try {
                        window.storage.set('coffee-products', JSON.stringify(newProducts));
                    } catch (error) {
                        console.error('ÃœrÃ¼n kaydetme hatasÄ±:', error);
                    }
                }
            };

            const saveSuppliers = (newSuppliers) => {
                setSuppliers(newSuppliers);
                if (typeof window.storage !== 'undefined') {
                    try {
                        window.storage.set('coffee-suppliers', JSON.stringify(newSuppliers));
                    } catch (error) {
                        console.error('TedarikÃ§i kaydetme hatasÄ±:', error);
                    }
                }
            };

            const saveOrderHistory = (newHistory) => {
                setOrderHistory(newHistory);
                if (typeof window.storage !== 'undefined') {
                    try {
                        window.storage.set('coffee-order-history', JSON.stringify(newHistory));
                    } catch (error) {
                        console.error('GeÃ§miÅŸ kaydetme hatasÄ±:', error);
                    }
                }
            };

            const showNotification = (message, type = 'success') => {
                const notification = document.createElement('div');
                const bgColor = type === 'success' ? '#22c55e' : type === 'error' ? '#ef4444' : '#f59e0b';
                notification.style.cssText = `position:fixed;top:16px;left:50%;transform:translateX(-50%);background:${bgColor};color:white;padding:12px 24px;border-radius:8px;box-shadow:0 4px 6px rgba(0,0,0,0.1);z-index:9999;font-weight:600;`;
                notification.textContent = message;
                document.body.appendChild(notification);
                setTimeout(() => notification.remove(), 3000);
            };

            const addCategory = () => {
                if (!newCategory.name.trim()) {
                    showNotification('âŒ Kategori adÄ± girin', 'error');
                    return;
                }
                const newCat = { id: Date.now(), ...newCategory };
                saveCategories([...categories, newCat]);
                setNewCategory({ name: '', icon: 'ðŸ“¦' });
                setShowAddCategory(false);
                showNotification('âœ“ Kategori eklendi', 'success');
            };

            const addProduct = () => {
                if (!newProduct.name.trim()) {
                    showNotification('âŒ ÃœrÃ¼n adÄ± giriniz', 'error');
                    return;
                }
                if (!selectedCategory) {
                    showNotification('âŒ LÃ¼tfen bir kategori seÃ§in', 'error');
                    return;
                }
                const newProd = { 
                    id: Date.now(), 
                    categoryId: selectedCategory, 
                    ...newProduct,
                    minStock: parseFloat(newProduct.minStock) || 0,
                    current: parseFloat(newProduct.current) || 0,
                    orderQty: 0,
                    orderStatus: ''
                };
                saveProducts([...products, newProd]);
                setNewProduct({ name: '', unit: 'adet', current: 0, orderQty: 0, minStock: 0, supplier: '', orderStatus: '' });
                setShowAddProduct(false);
                showNotification('âœ“ ÃœrÃ¼n baÅŸarÄ±yla eklendi', 'success');
            };

            const addSupplier = () => {
                if (!newSupplier.trim()) {
                    showNotification('âŒ TedarikÃ§i adÄ± girin', 'error');
                    return;
                }
                if (suppliers.includes(newSupplier.trim())) {
                    showNotification('âŒ Bu tedarikÃ§i zaten mevcut', 'error');
                    return;
                }
                saveSuppliers([...suppliers, newSupplier.trim()]);
                setNewSupplier('');
                setShowAddSupplier(false);
                showNotification('âœ“ TedarikÃ§i eklendi', 'success');
            };

            const updateProduct = (id, field, value) => {
                setProducts(prevProducts => {
                    const newProducts = prevProducts.map(p => {
                        if (p.id === id) {
                            const updated = { ...p, [field]: value };
                            // SipariÅŸ girilince "SipariÅŸ Verildi" badge'ini kaldÄ±r
                            if (field === 'orderQty' && parseFloat(value) > 0 && p.orderStatus === 'ordered') {
                                updated.orderStatus = '';
                            }
                            return updated;
                        }
                        return p;
                    });
                    
                    if (typeof window.storage !== 'undefined') {
                        setTimeout(() => {
                            try {
                                window.storage.set('coffee-products', JSON.stringify(newProducts));
                            } catch (error) {
                                console.error('Kaydetme hatasÄ±:', error);
                            }
                        }, 100);
                    }
                    
                    return newProducts;
                });
            };

            const quickUpdateStock = (id, amount) => {
                setProducts(prevProducts => {
                    const newProducts = prevProducts.map(p => {
                        if (p.id === id) {
                            const newStock = Math.max(0, (parseFloat(p.current) || 0) + amount);
                            return { ...p, current: newStock };
                        }
                        return p;
                    });
                    
                    if (typeof window.storage !== 'undefined') {
                        setTimeout(() => {
                            try {
                                window.storage.set('coffee-products', JSON.stringify(newProducts));
                            } catch (error) {
                                console.error('Kaydetme hatasÄ±:', error);
                            }
                        }, 100);
                    }
                    
                    return newProducts;
                });
            };

            const saveEditedProduct = () => {
                if (!editingProduct.name.trim()) {
                    showNotification('âŒ ÃœrÃ¼n adÄ± boÅŸ olamaz', 'error');
                    return;
                }
                const newProducts = products.map(p => 
                    p.id === editingProduct.id ? editingProduct : p
                );
                saveProducts(newProducts);
                setEditingProduct(null);
                showNotification('âœ“ ÃœrÃ¼n gÃ¼ncellendi', 'success');
            };

            const deleteProduct = (id) => {
                if (confirm('Bu Ã¼rÃ¼nÃ¼ silmek istediÄŸinize emin misiniz?')) {
                    saveProducts(products.filter(p => p.id !== id));
                    showNotification('âœ“ ÃœrÃ¼n silindi', 'success');
                }
            };

            const deleteCategory = (id) => {
                const categoryProducts = products.filter(p => p.categoryId === id);
                if (categoryProducts.length > 0) {
                    showNotification('âŒ Bu kategoride Ã¼rÃ¼nler var. Ã–nce Ã¼rÃ¼nleri silin.', 'error');
                    return;
                }
                if (confirm('Bu kategoriyi silmek istediÄŸinize emin misiniz?')) {
                    saveCategories(categories.filter(c => c.id !== id));
                    if (selectedCategory === id) setSelectedCategory(null);
                    showNotification('âœ“ Kategori silindi', 'success');
                }
            };

            const deleteSupplier = (supplierName) => {
                const productsWithSupplier = products.filter(p => p.supplier === supplierName);
                if (productsWithSupplier.length > 0) {
                    showNotification(`âŒ Bu tedarikÃ§iye baÄŸlÄ± ${productsWithSupplier.length} Ã¼rÃ¼n var.`, 'error');
                    return;
                }
                if (confirm(`"${supplierName}" tedarikÃ§isini silmek istediÄŸinize emin misiniz?`)) {
                    saveSuppliers(suppliers.filter(s => s !== supplierName));
                    showNotification('âœ“ TedarikÃ§i silindi', 'success');
                }
            };

            const getTotalOrderItems = () => {
                return products.filter(p => p.orderQty > 0).length;
            };

            const getLowStockProducts = () => {
                return products.filter(p => p.current <= p.minStock);
            };

            const getCategoryStats = () => {
                return categories.map(cat => {
                    const categoryProducts = products.filter(p => p.categoryId === cat.id);
                    const lowStockCount = categoryProducts.filter(p => p.current <= p.minStock).length;
                    const totalStock = categoryProducts.reduce((sum, p) => sum + (parseFloat(p.current) || 0), 0);
                    return {
                        ...cat,
                        productCount: categoryProducts.length,
                        lowStockCount,
                        totalStock: totalStock.toFixed(1)
                    };
                });
            };

            const confirmAndExportOrder = () => {
                const orderItems = products.filter(p => p.orderQty > 0);
                if (orderItems.length === 0) {
                    showNotification('âŒ SipariÅŸ listesi boÅŸ', 'error');
                    return;
                }
                setShowOrderConfirm(true);
            };

            const exportOrderList = () => {
                const orderItems = products.filter(p => p.orderQty > 0);
                
                const excelData = [
                    ['SÄ°PARÄ°Åž LÄ°STESÄ°'],
                    ['Tarih:', new Date().toLocaleDateString('tr-TR', { year: 'numeric', month: 'long', day: 'numeric' })],
                    ['Saat:', new Date().toLocaleTimeString('tr-TR')],
                    ['SipariÅŸ Veren:', userName],
                    [],
                    ['Kategori', 'ÃœrÃ¼n', 'TedarikÃ§i', 'Birim', 'Mevcut Stok', 'SipariÅŸ MiktarÄ±', 'Notlar'],
                    ...orderItems.map(p => {
                        const cat = categories.find(c => c.id === p.categoryId);
                        return [
                            cat?.name || '', p.name, p

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‚òï Kahve Stok Takip</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { -webkit-tap-highlight-color: transparent; }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icons (Lucide React alternatifi)
        const Plus = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>;
        const Save = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg>;
        const ShoppingCart = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>;
        const Menu = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>;
        const X = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>;
        const Trash2 = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>;

        const CoffeeInventory = () => {
            const defaultCategories = [
                { id: 1, name: 'Kahve & √áekirdek', icon: '‚òï' },
                { id: 2, name: 'S√ºt & Krema', icon: 'ü•õ' },
                { id: 3, name: '≈ûeker & Tatlandƒ±rƒ±cƒ±', icon: 'üç¨' },
                { id: 4, name: 'Bardak & Kapak', icon: 'ü•§' },
                { id: 5, name: 'Sos & ≈ûurup', icon: 'üçØ' },
                { id: 6, name: 'Diƒüer Malzemeler', icon: 'üì¶' },
            ];

            const defaultProducts = [
                { id: 1, categoryId: 1, name: 'Espresso √áekirdeƒüi', unit: 'kg', current: 5, orderQty: 0 },
                { id: 2, categoryId: 1, name: 'Filter Kahve √áekirdeƒüi', unit: 'kg', current: 3, orderQty: 0 },
                { id: 3, categoryId: 2, name: 'Tam Yaƒülƒ± S√ºt', unit: 'litre', current: 15, orderQty: 0 },
                { id: 4, categoryId: 2, name: 'Laktoz Free S√ºt', unit: 'litre', current: 5, orderQty: 0 },
                { id: 5, categoryId: 3, name: '≈ûeker Paketi', unit: 'adet', current: 200, orderQty: 0 },
                { id: 6, categoryId: 3, name: 'Stevia', unit: 'adet', current: 50, orderQty: 0 },
                { id: 7, categoryId: 4, name: 'K√º√ß√ºk Bardak', unit: 'adet', current: 150, orderQty: 0 },
                { id: 8, categoryId: 4, name: 'B√ºy√ºk Bardak', unit: 'adet', current: 120, orderQty: 0 },
                { id: 9, categoryId: 4, name: 'Kapak', unit: 'adet', current: 180, orderQty: 0 },
                { id: 10, categoryId: 5, name: '√áikolata Sosu', unit: '≈üi≈üe', current: 2, orderQty: 0 },
                { id: 11, categoryId: 5, name: 'Karamel Sosu', unit: '≈üi≈üe', current: 3, orderQty: 0 },
            ];

            const [categories, setCategories] = useState(defaultCategories);
            const [products, setProducts] = useState(defaultProducts);
            const [selectedCategory, setSelectedCategory] = useState(null);
            const [showMenu, setShowMenu] = useState(false);
            const [showAddCategory, setShowAddCategory] = useState(false);
            const [showAddProduct, setShowAddProduct] = useState(false);
            const [newCategory, setNewCategory] = useState({ name: '', icon: 'üì¶' });
            const [newProduct, setNewProduct] = useState({ name: '', unit: 'adet', current: 0, orderQty: 0 });
            const [userName, setUserName] = useState('');
            const [showNamePrompt, setShowNamePrompt] = useState(true);

            useEffect(() => {
                loadData();
            }, []);

            const loadData = () => {
                const savedCategories = localStorage.getItem('coffee-categories');
                const savedProducts = localStorage.getItem('coffee-products');
                
                if (savedCategories) {
                    setCategories(JSON.parse(savedCategories));
                }
                if (savedProducts) {
                    setProducts(JSON.parse(savedProducts));
                }
            };

            const saveCategories = (newCategories) => {
                setCategories(newCategories);
                localStorage.setItem('coffee-categories', JSON.stringify(newCategories));
            };

            const saveProducts = (newProducts) => {
                setProducts(newProducts);
                localStorage.setItem('coffee-products', JSON.stringify(newProducts));
            };

            const addCategory = () => {
                if (!newCategory.name.trim()) {
                    alert('Kategori adƒ± girin');
                    return;
                }
                const newCat = { id: Date.now(), ...newCategory };
                saveCategories([...categories, newCat]);
                setNewCategory({ name: '', icon: 'üì¶' });
                setShowAddCategory(false);
                showNotification('Kategori eklendi');
            };

            const addProduct = () => {
                if (!newProduct.name.trim()) {
                    alert('√úr√ºn adƒ± girin');
                    return;
                }
                if (!selectedCategory) {
                    alert('√ñnce bir kategori se√ßin');
                    return;
                }
                const newProd = { id: Date.now(), categoryId: selectedCategory, ...newProduct };
                saveProducts([...products, newProd]);
                setNewProduct({ name: '', unit: 'adet', current: 0, orderQty: 0 });
                setShowAddProduct(false);
                showNotification('√úr√ºn eklendi');
            };

            const updateProduct = (id, field, value) => {
                const newProducts = products.map(p => 
                    p.id === id ? { ...p, [field]: parseFloat(value) || 0 } : p
                );
                saveProducts(newProducts);
            };

            const deleteProduct = (id) => {
                if (confirm('Bu √ºr√ºn√º silmek istediƒüinize emin misiniz?')) {
                    saveProducts(products.filter(p => p.id !== id));
                    showNotification('√úr√ºn silindi');
                }
            };

            const deleteCategory = (id) => {
                const categoryProducts = products.filter(p => p.categoryId === id);
                if (categoryProducts.length > 0) {
                    alert('Bu kategoride √ºr√ºnler var. √ñnce √ºr√ºnleri silin.');
                    return;
                }
                if (confirm('Bu kategoriyi silmek istediƒüinize emin misiniz?')) {
                    saveCategories(categories.filter(c => c.id !== id));
                    if (selectedCategory === id) setSelectedCategory(null);
                    showNotification('Kategori silindi');
                }
            };

            const showNotification = (message) => {
                const notification = document.createElement('div');
                notification.style.cssText = 'position:fixed;top:16px;left:50%;transform:translateX(-50%);background:#22c55e;color:white;padding:12px 24px;border-radius:8px;box-shadow:0 4px 6px rgba(0,0,0,0.1);z-index:9999;';
                notification.textContent = '‚úì ' + message;
                document.body.appendChild(notification);
                setTimeout(() => notification.remove(), 2000);
            };

            const getTotalOrderItems = () => {
                return products.filter(p => p.orderQty > 0).length;
            };

            const exportOrderList = () => {
                const orderItems = products.filter(p => p.orderQty > 0);
                if (orderItems.length === 0) {
                    alert('Sipari≈ü listesi bo≈ü');
                    return;
                }
                
                const csv = [
                    ['Kategori', '√úr√ºn', 'Birim', 'Mevcut Stok', 'Sipari≈ü Miktarƒ±'],
                    ...orderItems.map(p => {
                        const cat = categories.find(c => c.id === p.categoryId);
                        return [cat?.name || '', p.name, p.unit, p.current, p.orderQty];
                    })
                ].map(row => row.join(',')).join('\n');
                
                const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `siparis-${new Date().toLocaleDateString('tr-TR')}.csv`;
                link.click();
                showNotification('Sipari≈ü listesi indirildi');
            };

            const clearAllOrders = () => {
                if (confirm('T√ºm sipari≈ü miktarlarƒ±nƒ± sƒ±fƒ±rlamak istediƒüinize emin misiniz?')) {
                    const newProducts = products.map(p => ({ ...p, orderQty: 0 }));
                    saveProducts(newProducts);
                    showNotification('Sipari≈ü listesi temizlendi');
                }
            };

            if (showNamePrompt && !userName) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-sm w-full">
                            <div className="text-center mb-6">
                                <div className="text-6xl mb-4">‚òï</div>
                                <h1 className="text-2xl font-bold text-amber-900">Stok Y√∂netimi</h1>
                                <p className="text-gray-600 mt-2">Ho≈ü geldiniz!</p>
                            </div>
                            <input
                                type="text"
                                placeholder="ƒ∞sminizi girin"
                                className="w-full px-4 py-3 border-2 border-amber-200 rounded-lg text-lg focus:border-amber-500 focus:outline-none"
                                onKeyPress={(e) => {
                                    if (e.key === 'Enter' && e.target.value.trim()) {
                                        setUserName(e.target.value.trim());
                                        setShowNamePrompt(false);
                                    }
                                }}
                                autoFocus
                            />
                            <button
                                onClick={(e) => {
                                    const input = e.target.previousSibling;
                                    if (input.value.trim()) {
                                        setUserName(input.value.trim());
                                        setShowNamePrompt(false);
                                    }
                                }}
                                className="w-full mt-4 bg-amber-600 text-white py-3 rounded-lg font-semibold text-lg hover:bg-amber-700 active:bg-amber-800"
                            >
                                Ba≈üla
                            </button>
                        </div>
                    </div>
                );
            }

            const filteredProducts = selectedCategory 
                ? products.filter(p => p.categoryId === selectedCategory)
                : products;

            return (
                <div className="min-h-screen bg-gray-50 pb-24">
                    <div className="bg-gradient-to-r from-amber-600 to-orange-600 text-white p-4 shadow-lg sticky top-0 z-40">
                        <div className="flex items-center justify-between">
                            <div>
                                <h1 className="text-xl font-bold">‚òï Stok Y√∂netimi</h1>
                                <p className="text-sm text-amber-100">{userName}</p>
                            </div>
                            <button
                                onClick={() => setShowMenu(!showMenu)}
                                className="p-2 hover:bg-white/20 rounded-lg"
                            >
                                {showMenu ? <X /> : <Menu />}
                            </button>
                        </div>
                    </div>

                    {showMenu && (
                        <div className="fixed inset-0 bg-black/50 z-50" onClick={() => setShowMenu(false)}>
                            <div className="absolute right-0 top-0 h-full w-72 bg-white shadow-xl p-4 overflow-y-auto" onClick={(e) => e.stopPropagation()}>
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="font-bold text-lg">Men√º</h3>
                                    <button onClick={() => setShowMenu(false)}><X /></button>
                                </div>
                                
                                <div className="mb-6">
                                    <h4 className="font-semibold mb-3 text-gray-700">Kategoriler</h4>
                                    {categories.map(cat => (
                                        <div key={cat.id} className="flex items-center justify-between p-2 hover:bg-gray-50 rounded">
                                            <span>{cat.icon} {cat.name}</span>
                                            <button onClick={() => deleteCategory(cat.id)} className="text-red-600 p-1">
                                                <Trash2 />
                                            </button>
                                        </div>
                                    ))}
                                    <button
                                        onClick={() => setShowAddCategory(true)}
                                        className="w-full mt-2 flex items-center justify-center gap-2 p-2 bg-amber-100 text-amber-700 rounded-lg"
                                    >
                                        <Plus />
                                        Kategori Ekle
                                    </button>
                                </div>

                                <div className="space-y-2 border-t pt-4">
                                    <button
                                        onClick={() => { exportOrderList(); setShowMenu(false); }}
                                        className="w-full flex items-center gap-3 p-3 hover:bg-gray-100 rounded-lg"
                                    >
                                        <ShoppingCart />
                                        <span>Sipari≈ü Listesini ƒ∞ndir</span>
                                    </button>
                                    <button
                                        onClick={() => { clearAllOrders(); setShowMenu(false); }}
                                        className="w-full flex items-center gap-3 p-3 hover:bg-gray-100 rounded-lg text-red-600"
                                    >
                                        <Trash2 />
                                        <span>Sipari≈üleri Temizle</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showAddCategory && (
                        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full">
                                <h3 className="text-xl font-bold mb-4">Yeni Kategori</h3>
                                <input
                                    type="text"
                                    placeholder="Kategori adƒ±"
                                    value={newCategory.name}
                                    onChange={(e) => setNewCategory({ ...newCategory, name: e.target.value })}
                                    className="w-full px-4 py-3 border rounded-lg mb-3"
                                />
                                <input
                                    type="text"
                                    placeholder="Emoji (√∂rn: üç∞)"
                                    value={newCategory.icon}
                                    onChange={(e) => setNewCategory({ ...newCategory, icon: e.target.value })}
                                    className="w-full px-4 py-3 border rounded-lg mb-4"
                                />
                                <div className="flex gap-2">
                                    <button onClick={addCategory} className="flex-1 bg-amber-600 text-white py-3 rounded-lg font-semibold">
                                        Ekle
                                    </button>
                                    <button onClick={() => setShowAddCategory(false)} className="flex-1 bg-gray-200 py-3 rounded-lg font-semibold">
                                        ƒ∞ptal
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showAddProduct && (
                        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full">
                                <h3 className="text-xl font-bold mb-4">Yeni √úr√ºn</h3>
                                <input
                                    type="text"
                                    placeholder="√úr√ºn adƒ±"
                                    value={newProduct.name}
                                    onChange={(e) => setNewProduct({ ...newProduct, name: e.target.value })}
                                    className="w-full px-4 py-3 border rounded-lg mb-3"
                                />
                                <select
                                    value={newProduct.unit}
                                    onChange={(e) => setNewProduct({ ...newProduct, unit: e.target.value })}
                                    className="w-full px-4 py-3 border rounded-lg mb-3"
                                >
                                    <option value="adet">Adet</option>
                                    <option value="kg">Kilogram</option>
                                    <option value="litre">Litre</option>
                                    <option value="paket">Paket</option>
                                    <option value="≈üi≈üe">≈ûi≈üe</option>
                                    <option value="kutu">Kutu</option>
                                </select>
                                <input
                                    type="number"
                                    placeholder="Mevcut stok"
                                    value={newProduct.current}
                                    onChange={(e) => setNewProduct({ ...newProduct, current: e.target.value })}
                                    className="w-full px-4 py-3 border rounded-lg mb-4"
                                />
                                <div className="flex gap-2">
                                    <button onClick={addProduct} className="flex-1 bg-amber-600 text-white py-3 rounded-lg font-semibold">
                                        Ekle
                                    </button>
                                    <button onClick={() => setShowAddProduct(false)} className="flex-1 bg-gray-200 py-3 rounded-lg font-semibold">
                                        ƒ∞ptal
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="p-4 overflow-x-auto">
                        <div className="flex gap-2 mb-4">
                            <button
                                onClick={() => setSelectedCategory(null)}
                                className={`px-4 py-2 rounded-full font-semibold whitespace-nowrap ${
                                    selectedCategory === null ? 'bg-amber-600 text-white' : 'bg-white text-gray-700'
                                }`}
                            >
                                T√ºm√º
                            </button>
                            {categories.map(cat => (
                                <button
                                    key={cat.id}
                                    onClick={() => setSelectedCategory(cat.id)}
                                    className={`px-4 py-2 rounded-full font-semibold whitespace-nowrap ${
                                        selectedCategory === cat.id ? 'bg-amber-600 text-white' : 'bg-white text-gray-700'
                                    }`}
                                >
                                    {cat.icon} {cat.name}
                                </button>
                            ))}
                        </div>
                    </div>

                    <div className="px-4 space-y-3">
                        {filteredProducts.map(product => (
                            <div key={product.id} className="bg-white rounded-xl shadow-md p-4">
                                <div className="flex justify-between items-start mb-3">
                                    <h3 className="font-bold text-gray-800">{product.name}</h3>
                                    <button onClick={() => deleteProduct(product.id)} className="text-red-600 p-1">
                                        <Trash2 />
                                    </button>
                                </div>
                                
                                <div className="grid grid-cols-2 gap-3">
                                    <div>
                                        <label className="text-xs text-gray-600 mb-1 block">Mevcut Stok</label>
                                        <div className="flex items-center gap-2">
                                            <input
                                                type="number"
                                                value={product.current}
                                                onChange={(e) => updateProduct(product.id, 'current', e.target.value)}
                                                className="w-full px-3 py-2 border rounded-lg font-semibold"
                                            />
                                            <span className="text-gray-600 text-sm">{product.unit}</span>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label className="text-xs text-gray-600 mb-1 block">Sipari≈ü Ver</label>
                                        <div className="flex items-center gap-2">
                                            <input
                                                type="number"
                                                value={product.orderQty}
                                                onChange={(e) => updateProduct(product.id, 'orderQty', e.target.value)}
                                                className="w-full px-3 py-2 border rounded-lg font-semibold bg-orange-50 border-orange-300"
                                            />
                                            <span className="text-gray-600 text-sm">{product.unit}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>

                    <div className="fixed bottom-6 right-6 z-50">
                        {getTotalOrderItems() > 0 && (
                            <button
                                onClick={exportOrderList}
                                className="mb-3 bg-green-600 text-white p-4 rounded-full shadow-2xl flex items-center gap-2"
                            >
                                <ShoppingCart />
                                <span className="bg-white text-green-600 px-2 py-1 rounded-full text-sm font-bold">
                                    {getTotalOrderItems()}
                                </span>
                            </button>
                        )}
                        <button
                            onClick={() => setShowAddProduct(true)}
                            className="bg-amber-600 text-white p-5 rounded-full shadow-2xl"
                        >
                            <Plus />
                        </button>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<CoffeeInventory />, document.getElementById('root'));
    </script>
</body>
</html>
